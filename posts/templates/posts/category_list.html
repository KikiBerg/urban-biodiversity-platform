{% extends 'base.html' %} 
{% load static %}
{% load crispy_forms_tags %}

{% block content %}

<div class="container mt-4">  
  <h1 class="mb-4">Categories</h1>

  {% if user.is_authenticated %}
    <a href="{% url 'category_create' %}" class="btn btn-primary mb-3"><i class="fas fa-plus"></i>Add Category</a>
  {% else %} 
  <p>You are viewing approved categories. Please register or login to manage your own categories.</p>
  {% endif %}
  
  
  
  <div class="list-group">
    {% for category in categories %}
    <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
      <a href="{% url 'category_post_list' category.pk %}" class="text-decoration-none">
        <h5 class="mb-1">{{ category.name }}</h5>
        <p class="mb-1 text-muted">{{ category.description|truncatewords:20 }}</p>
      </a>
      
      {% if user.is_authenticated %}
        {% if user.is_superuser or category.created_by == user %}     
        <div>
          <a href="{% url 'category_update' category.pk %}" class="btn btn-sm btn-outline-secondary"><i class="fas fa-edit"></i>Edit</a>
          <a href="{% url 'category_delete' category.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
        </div>
        {% endif %}
        <span class="badge {% if category.status == 'approved' %}bg-success{% elif category.status == 'rejected' %}bg-danger{% else %}bg-warning text-dark{% endif %}">
          {{ category.get_status_display }}
        </span>
      {% endif %}
    </div>    
    {% empty %}
    <div class="alert alert-info" role="alert">
      No categories found.
    </div>    
    {% endfor %}
  </div>
</div>   
{% endblock %}
